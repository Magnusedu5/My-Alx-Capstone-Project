{% extends "base.html" %}

{% block title %}Manage Documents{% endblock %}

{% block content %}
<div class="container">
    <h2>Manage Department Documents</h2>
    <a href="{% url 'dashboard' %}" class="btn btn-secondary">‚Üê Back to Dashboard</a>

    {% if messages %}
        {% for message in messages %}
            <div class="alert alert-{{ message.tags }}">{{ message }}</div>
        {% endfor %}
    {% endif %}

    {% if documents %}
        <div class="documents-list">
            <h3>Pending Document Approvals</h3>
            {% for document in documents %}
                <div class="document-card">
                    <div class="document-info">
                        <strong>{{ document.title }}</strong><br>
                        <span>Uploaded by: {{ document.uploaded_by.name }}</span><br>
                        <span>Upload Date: {{ document.upload_date|date:"Y-m-d H:i" }}</span><br>
                        <span>Status: {{ document.status }}</span>
                        {% if document.file %}
                            <br><a href="{{ document.file.url }}" target="_blank" class="file-link">üìÑ View File</a>
                        {% endif %}
                    </div>
                    <div class="document-actions">
                        <form method="post" style="display: inline;">
                            {% csrf_token %}
                            <input type="hidden" name="doc_id" value="{{ document.id }}">
                            <input type="hidden" name="action" value="approve">
                            <button type="submit" class="btn btn-success">Approve</button>
                        </form>
                        <form method="post" style="display: inline;">
                            {% csrf_token %}
                            <input type="hidden" name="doc_id" value="{{ document.id }}">
                            <input type="hidden" name="action" value="reject">
                            <button type="submit" class="btn btn-danger" onclick="return confirm('Are you sure you want to reject this document?')">Reject</button>
                        </form>
                    </div>
                </div>
            {% endfor %}
        </div>
    {% else %}
        <p>No pending document approvals.</p>
    {% endif %}
</div>

<style>
.document-card {
    border: 1px solid #ddd;
    padding: 15px;
    margin: 10px 0;
    border-radius: 5px;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.document-info {
    flex: 1;
}

.document-actions {
    display: flex;
    gap: 10px;
}

.file-link {
    color: #007bff;
    text-decoration: none;
}

.file-link:hover {
    text-decoration: underline;
}

.btn {
    padding: 8px 16px;
    border: none;
    border-radius: 4px;
    text-decoration: none;
    cursor: pointer;
}

.btn-success {
    background-color: #28a745;
    color: white;
}

.btn-danger {
    background-color: #dc3545;
    color: white;
}

.btn-secondary {
    background-color: #6c757d;
    color: white;
    margin-bottom: 20px;
    display: inline-block;
}

.alert {
    padding: 10px;
    margin: 10px 0;
    border-radius: 4px;
}

.alert-success {
    background-color: #d4edda;
    color: #155724;
    border: 1px solid #c3e6cb;
}

.alert-error {
    background-color: #f8d7da;
    color: #721c24;
    border: 1px solid #f5c6cb;
}
</style>
{% endblock %}