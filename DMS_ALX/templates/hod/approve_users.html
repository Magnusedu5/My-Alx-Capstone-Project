{% extends "base.html" %}

{% block title %}Approve Users{% endblock %}

{% block content %}
<div class="container">
    <h2>Approve Staff Accounts</h2>
    <a href="{% url 'dashboard' %}" class="btn btn-secondary">‚Üê Back to Dashboard</a>

    {% if messages %}
        {% for message in messages %}
            <div class="alert alert-{{ message.tags }}">{{ message }}</div>
        {% endfor %}
    {% endif %}

    {% if pending_users %}
        <div class="users-list">
            <h3>Pending User Approvals</h3>
            {% for user in pending_users %}
                <div class="user-card">
                    <div class="user-info">
                        <strong>{{ user.name }}</strong><br>
                        <span>Email: {{ user.staff_email }}</span><br>
                        <span>Role: {{ user.role }}</span><br>
                        <span>Department: {{ user.department|default:"Not assigned" }}</span>
                    </div>
                    <div class="user-actions">
                        <form method="post" style="display: inline;">
                            {% csrf_token %}
                            <input type="hidden" name="user_id" value="{{ user.id }}">
                            <input type="hidden" name="action" value="approve">
                            <button type="submit" class="btn btn-success">Approve</button>
                        </form>
                        <form method="post" style="display: inline;">
                            {% csrf_token %}
                            <input type="hidden" name="user_id" value="{{ user.id }}">
                            <input type="hidden" name="action" value="reject">
                            <button type="submit" class="btn btn-danger" onclick="return confirm('Are you sure you want to reject this user?')">Reject</button>
                        </form>
                    </div>
                </div>
            {% endfor %}
        </div>
    {% else %}
        <p>No pending user approvals.</p>
    {% endif %}
</div>

<style>
.user-card {
    border: 1px solid #ddd;
    padding: 15px;
    margin: 10px 0;
    border-radius: 5px;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.user-info {
    flex: 1;
}

.user-actions {
    display: flex;
    gap: 10px;
}

.btn {
    padding: 8px 16px;
    border: none;
    border-radius: 4px;
    text-decoration: none;
    cursor: pointer;
}

.btn-success {
    background-color: #28a745;
    color: white;
}

.btn-danger {
    background-color: #dc3545;
    color: white;
}

.btn-secondary {
    background-color: #6c757d;
    color: white;
    margin-bottom: 20px;
    display: inline-block;
}

.alert {
    padding: 10px;
    margin: 10px 0;
    border-radius: 4px;
}

.alert-success {
    background-color: #d4edda;
    color: #155724;
    border: 1px solid #c3e6cb;
}

.alert-error {
    background-color: #f8d7da;
    color: #721c24;
    border: 1px solid #f5c6cb;
}
</style>
{% endblock %}